(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{cs8U:function(t,e,i){"use strict";i.r(e),i.d(e,"AddStoryPageModule",(function(){return f}));var o=i("ofXK"),n=i("3Pt+"),r=i("TEn/"),s=i("tyNb"),c=i("fXoL"),l=i("JZ6Q"),a=i("lGQG");function d(t,e){1&t&&(c.Ob(0,"ion-card-header"),c.Ob(1,"ion-card-title",14),c.nc(2,"The New Story Awaits...."),c.Nb(),c.Nb())}function b(t,e){if(1&t&&c.Kb(0,"ion-img",15),2&t){const t=c.Yb();c.dc("src",t.edit&&!t.file?t.editStory.imageUrl:t.storyImage)}}function u(t,e){1&t&&(c.Ob(0,"ion-text",16),c.Ob(1,"small"),c.nc(2,"Please enter valid title(min 4 characters)."),c.Nb(),c.Nb())}function y(t,e){1&t&&(c.Ob(0,"ion-text",16),c.Ob(1,"small"),c.nc(2,"Please enter valid description(min 10 characters)."),c.Nb(),c.Nb())}function h(t,e){1&t&&(c.Ob(0,"ion-text",16),c.Ob(1,"small"),c.nc(2,"Please enter valid story(min 10 characters)."),c.Nb(),c.Nb())}const m=[{path:"",component:(()=>{class t{constructor(t,e,i,o,r){this.storyService=t,this.authService=e,this.loading=i,this.router=o,this.route=r,this.file=null,this.storyImage=null,this.edit=!1,this.storyForm=new n.d({title:new n.b(null,[n.l.required,n.l.minLength(4)]),description:new n.b(null,[n.l.required,n.l.minLength(10),n.l.maxLength(40)]),story:new n.b(null,[n.l.required,n.l.minLength(10),n.l.maxLength(500)])}),this.route.queryParams.subscribe(t=>{t&&(this.edit=t.edit,this.storyId=t.id,this.subsciption=this.storyService.getStory(this.storyId).subscribe(t=>{this.storyImage=t.imageUrl,this.editStory=t}))})}ngOnInit(){}submit(){this.loading.create({message:this.edit?"Making the changes...":"Adding the story..."}).then(t=>t.present()).then(()=>{this.edit?this.storyService.editStory(this.storyId,Object.assign(Object.assign({},this.storyForm.value),{image:this.file?this.file:"",authorId:this.authService.user,path:this.editStory.imagePath})):this.storyService.addStory(Object.assign(Object.assign({},this.storyForm.value),{image:this.file,authorid:this.authService.user}))}).then(()=>{console.log("story uploaded successfully"),this.storyImage=null,this.storyForm.reset(),this.loading.dismiss(),this.router.navigate(["","feed"])}).catch(t=>{console.log(t)})}openFileSelector(){document.getElementById("uploadBtn").click()}previewFile(t){if(this.file=t[0],t&&t[0]){const e=new FileReader;e.onload=t=>{this.storyImage=t.target.result},e.readAsDataURL(t[0])}}ionViewWillLeave(){this.subsciption.unsubscribe()}get title(){return this.storyForm.get("title")}get description(){return this.storyForm.get("description")}get story(){return this.storyForm.get("story")}}return t.\u0275fac=function(e){return new(e||t)(c.Jb(l.a),c.Jb(a.a),c.Jb(r.J),c.Jb(s.g),c.Jb(s.a))},t.\u0275cmp=c.Db({type:t,selectors:[["app-add-story"]],decls:35,vars:13,consts:[["slot","start"],["defaultHref","/feed"],["size-md","10","offset-md","1"],[4,"ngIf"],[3,"src",4,"ngIf"],["expand","block","shape","round",3,"click"],["id","uploadBtn","type","file",1,"upload",3,"hidden","change"],[3,"formGroup","ngSubmit"],["position","floating"],["type","text","formControlName","title",3,"value"],["color","danger",4,"ngIf"],["type","text","formControlName","description",3,"value"],["formControlName","story","rows","5",3,"value"],["type","submit","expand","block",3,"disabled"],["id","msg"],[3,"src"],["color","danger"]],template:function(t,e){1&t&&(c.Ob(0,"ion-header"),c.Ob(1,"ion-toolbar"),c.Ob(2,"ion-title"),c.nc(3),c.Nb(),c.Ob(4,"ion-buttons",0),c.Kb(5,"ion-back-button",1),c.Nb(),c.Nb(),c.Nb(),c.Ob(6,"ion-content"),c.Ob(7,"ion-grid"),c.Ob(8,"ion-row"),c.Ob(9,"ion-col",2),c.Ob(10,"ion-card"),c.lc(11,d,3,0,"ion-card-header",3),c.Ob(12,"ion-card-content"),c.lc(13,b,1,1,"ion-img",4),c.Ob(14,"ion-button",5),c.Wb("click",(function(){return e.openFileSelector()})),c.nc(15),c.Ob(16,"input",6),c.Wb("change",(function(t){return e.previewFile(t.target.files)})),c.Nb(),c.Nb(),c.Ob(17,"form",7),c.Wb("ngSubmit",(function(){return e.submit()})),c.Ob(18,"ion-item"),c.Ob(19,"ion-label",8),c.nc(20,"Title"),c.Nb(),c.Kb(21,"ion-input",9),c.Nb(),c.lc(22,u,3,0,"ion-text",10),c.Ob(23,"ion-item"),c.Ob(24,"ion-label",8),c.nc(25,"Description"),c.Nb(),c.Kb(26,"ion-input",11),c.Nb(),c.lc(27,y,3,0,"ion-text",10),c.Ob(28,"ion-item"),c.Ob(29,"ion-label",8),c.nc(30,"Enter the Story"),c.Nb(),c.Kb(31,"ion-textarea",12),c.Nb(),c.lc(32,h,3,0,"ion-text",10),c.Ob(33,"ion-button",13),c.nc(34," Submit "),c.Nb(),c.Nb(),c.Nb(),c.Nb(),c.Nb(),c.Nb(),c.Nb(),c.Nb()),2&t&&(c.yb(3),c.oc(e.edit?"Edit Story":"Add Story"),c.yb(8),c.dc("ngIf",!e.edit),c.yb(2),c.dc("ngIf",e.storyImage),c.yb(2),c.pc(" ",e.file||e.edit?"Change Image":"Select Image"," "),c.yb(1),c.dc("hidden",!0),c.yb(1),c.dc("formGroup",e.storyForm),c.yb(4),c.dc("value",e.edit&&e.editStory?e.editStory.title:""),c.yb(1),c.dc("ngIf",e.title.invalid&&(e.title.dirty||e.title.touched)),c.yb(4),c.dc("value",e.edit&&e.editStory?e.editStory.description:""),c.yb(1),c.dc("ngIf",e.description.invalid&&(e.description.dirty||e.description.touched)),c.yb(4),c.dc("value",e.edit&&e.editStory?e.editStory.story:""),c.yb(1),c.dc("ngIf",e.story.invalid&&(e.story.dirty||e.story.touched)),c.yb(1),c.dc("disabled",e.title.invalid||e.description.invalid||e.story.invalid))},directives:[r.o,r.G,r.F,r.f,r.c,r.d,r.m,r.n,r.y,r.l,r.g,o.j,r.h,r.e,n.m,n.j,n.e,r.r,r.s,r.q,r.O,n.i,n.c,r.D,r.i,r.k,r.p,r.C],styles:['@import url("https://fonts.googleapis.com/css2?family=Lobster&display=swap");#msg[_ngcontent-%COMP%]{font-family:Lobster,cursive}*[_ngcontent-%COMP%]{color:#fff}']}),t})()}];let g=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[s.j.forChild(m)],s.j]}),t})(),f=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[o.c,n.f,r.H,n.k,g]]}),t})()}}]);